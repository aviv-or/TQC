import chai, {expect} from 'chai'

const should = chai.should()
const pqccore = require('..');

const {PrivateKey, Networks, PublicKey} = pqccore

describe('PublicKey', () => {
  const pubhash = '040103000610391dd2a2e1cbec609d08d2542b801cbbf1a7bf69b25e5e500d48d1e44a9153f211774353c552cfc74319f5e3a2dec47124233d78fe8934fa8985f93331f1fac5d18cb265b717eb1fd4ac6a83bded8767e21ae5f7d31582d63c48422712b00ecdf4e953dbffb9791f77cdfa0885114711586566f9d3a0e8c34bcfd08f96638b5fc7ce8cd3a1dedfe0e17acdc067bf9fa70be3432a72427620c6a030568f364cf303d3e6e799154b3090ba9013d0d44b4de094d9267ae9551a4c08a9f803b34916df0461d5f52e16185eaaaac9222bc53bafec5ee9ef80a1b5aee0f96259ad45aa2f4390fab81462b355e9ab6e1f232d36a7b3b3b5e177d92069ab3192f99a58e59cdfa9e7698352eb433071d94dc5a340b945cf4ec477e9ff6d41e75c9e05e66a897f498df16ff385c81c38b39ace4192f8e4f9994f7773424dc200c19d12df2e91ed4259d30864fb14b343cafca2220b02be1d7d096696667785f5e0ac8cbd60e42ae1194c76cefdd453bf1c2ed2103d46470fa2c00212617467f0961bd5487989a70de6f81040c2311008cf74ec5103d6ec90d25289747bbb8bdafec42bbccf8d2e246d30d9e152c0a630ce9faf821431f85c7cf5e3359c825c70141b53c78443fcf9b8f2270252b9f73f03ba44133e007f40b4bab4dde272a6944ac40e9b3d9f917f17c33dfbe78d1dfc87f37117dd591b389711ed1f2b12e50a877cfca8c62e066ad708f0e063293b0fb2fe519995f63eeec95b469b409f858df545826a6f934db1c20b9dc4c9e53eda15e2ffe92d95b2908f9c5510814dc3eb30cf1afd7e18d262d3bff9ba39f65690d2625d396387b6cb1e39ac6c3e6fb1c6934d20f3131a6009c93ad2894fc6715681ca930c70f37d450474921c057a94df12d4c48caf552747b4c7f9945643290bf7a058b1f42eda54af005135f6e6694f01dff27210ec1a3cf3daf0b512551012cae6d657b2d13c9b0214720538e0904ee33aaa281b8c1c4493b2ce6f45b547185a5a3e87eb649cfa37ea42453f43da6614d4dde7fb209839e57453687e0ba7115b84466765896e606f40efbf85beb4128aea2c2c35513b39540ae4208a411aea0ca5e9b6c6a00f75440ab6a106179de81cb2d7b5b82f0163e98d604cca97b279d98ff8a31b1898979bb7d152a21abc638476047aa3ef2eee7e6680ed09c942bde78e90eb4229f6c7ccc90832cabf09cf0eef3047a8f1d6cd74fb4904994c239fb134822f79d1897044b4ce46fe68492d91994127f247fea975dbb5157deb4d6ebe7a56efce0d0dc2825048bc734d61eef6a91b81cbd25cb00a1e685d797c28c0dc53fd543b3d680ec653e67db1e6682f5c56d045bef16919b5ec1a8d2bb7f9c8e629316c58c7443160b89f6e0df25e9d6f276fe5ee91fe2bfb12431b993d6316ca20683c3727774d8c87cad498a846a0ed1bc8';

  describe('public key init', () => {
    it('should create public key from hash', () => {
      const key = new PublicKey(pubhash);
      key.toAddress().toString().should.equal('GdjFg6xxCEk3DZyphK98aqnwwVFZVSrwYV');
    });
  });

  describe('validating errors on creation', () => {
    it('errors if data is missing', () => {
      (function () {
        return new PublicKey();
      }).should.throw('First argument is required, please include public key data.');
    });

    it('errors if the argument is of an unrecognized type', () => {
      (function () {
        return new PublicKey(new Error());
      }).should.throw('First argument is an unrecognized data format.');
    });
  });

  describe('instantiation', () => {
    it('from a private key', () => {
      const privhex = '9076537d384f48189193c1643a26a26fb7a99f73259e960f407eb83ce80bef8dbff48a7cadb51d29a13b6b72ac37a8cf71e72a6fd8c868c6a98cc95ea0b794a87a';
      const pubhex = '04010300061006211b1b801ba417444337852f2b14dbb9905f0f61776fedb4aed9820b856209c8478bea599f46cb62c3985f9dc2ac019e55db2ce69a2fc7ece6c7d4cdd9e4358576c364bd6d2158055a5cbbd6ff38ec3c862ec5fdedb18c00c105c3f83688884707090dd19fe4654ae664150c97680e8373a1f4a18c0ec03265339c8370db1bedb39b648859f3eb88a403ab3be2a2abb5a1f7e99dd893d0cfb73ce13b19f561184798665202eae8d2edb8cc660bc94deba547870cadca2779682f13ac2da204111d3dc06391d286d251757e6b71b07bee584139594319f0c1604b53d386423a7dcc85fee68898131fba223f81b75d87935e0bbecf13f4c59ffd2bd4bd72af8932b9880d90904f526d4e78976ac62e68d285f95f634c3eab0890d235cca1c299358b6fbd05ba23e6a5f98afceee95e0ec3754b8ca4d7ab395ee73d6fa63b9ba06f9d4ec83166cf5d7a7f5d7171b3e2b18fb6af334fdbec94bd0f98e5a56b2f80e33987f8a2247fb2c894fecac74fd2530ee15fb6a9741f8fe4780086d0963b68d2c14efd99693915291455f3a53e46d60bd937cbbda3a48fbb2bc3a7dacead95cbb4bd12679c106c3fe29b447b5f75d6f6244e954ba31fe802ba3163926a3b2187fb87bbfd34fa382c8a229bec4fd7343000ec51886e14de07c88dd0e14a0932753a697a51786f7fcb9e90c7799fb091755d8ba31dd35e9fadf66089d1f8b586e515a27f7f2ce0113780bb50974266181553c0d4451831e444305f6982973b91ff631dece88ec15065fcd45e2d2ee23da866964a33ea46cdc2aacf8fe556ac4c522443bb44cf2cc0ffd0c4b833c18eb06bc166c94f3b2a1afb09f0af604e166d68a788990e61603bcf963948b1aa050535e7637eb2287e8aa70af3b9ff47520285883cd5f94975bb97ee061a03a6b9d6a871ceac4929a13bdd4cc15ee7cadfb3981319bb758278e751f26f57cab6a77bcec8c51b81a1db86d6ec191c90e86333420b294c69cefec6d55dbd649392588ddb17bc97156ed4effbe5a4b5385be14ffed2c4a44c06434698bef13df8063c396d0c88373da77252a84d6d2be5d8c1234ca69aad90561465a395a5900f3a62cfac71b220fab4cb3fb731634452ce560ba61f8f2d8ee5f5ba21b1ccc8fcdde411d1e51dac54ebde19f818f97092c3cf3f8af1c12e8c11c465b1b37ff096e364b7ef4b7c0d3029058c63ae4c36e5f7bd6bf554c70492545bc2c13b64731316df7ba54a932e1390b33c85c586267416a195d32b699204c0ca0ed28584702c2ae31179d21a3ea29acf702255f0d810a910548ff890acefb0486ca2244d16b9e43f106e70935c6c9cdc11233ddf89b8abf278f3c533fcc7ff9a8573bb87eba884847bd112473b0c07b0e7df0b490f3d02882a3d56d8a685e159a92d71770bd7f91daf76de052145055190009a3de5d738';
      const privkey = new PrivateKey(new Buffer(privhex, 'hex'));
      const pk = new PublicKey(privkey);
      pk.toString().should.equal(pubhex);
    });

    it('problematic secp256k1 public keys', () => {
      const knownKeys = [
        {
          wif: '2SRLnpdFnpiqzeAbJXSBoLeCvG65m7ham4N7ZuFuSgRSAmAVQwKDVrJnui3gY4Ywv7ZFVeW5QuFC4oakVAxetMxGVnvEyct',
          priv: '90951e9b84c4f35535699251dc79d27eeb02c1a5475e080d6108ea4932222755170a17fa034b54160857282e82026f37b72bd43441c9d775e739580a4d10ef4955',
          pub: '040103000610b56313e228ee5e3e3939e3c04a9f55289ae71591a356c13ec62cd1f4d39bf44c2c56005b5eb9b7f4824e7e894fc482227381f6953d429410598fd7edc62115bcdc0fc120ee54d8a50f4c106c4b3e8c1243f69672bd69e5e432118fba2339c7c5554ab871b118e8082e0d8f3e2141dc254eaed7182b7f3c6b566c94d44a933ec038238afe3bb3bd39643620d189b70e2409e24215ad0abdfedc88fa8edf8f245d163bebbaf58211fe0e1040b1e3f3caface234e61966239979c38f59f4936f591726f34e5cb66813721b916bfc209d21e040b57c813342bc23b55c1471816570750b3b60ca65ad7ef78ef26a03ace331ffbea32c346674dd01257b6c8c5aebd2ad6fd682277d63e5eda8d48d95c96df44ff42a3df74b9de2ae4827e5476af57fb434acfa8b4652c4bdba93ae45ad826c1e9b24fac9a1eb0deb81ac8b8a6c89ecd34b435bbe2de4c32f4ede632820c8f85419695742d52715ef8733c970a34da0fd5ff9c8a06b89893f6b5514af49c954a70497c99418f91fcb7f11b4402d501b891f1b0a1ea8297ab2d0e94b0d06e9acdf40fc360b17fbbdfdda3a07c8d969d3054c74b590e6c0d339d870d323db880d31f45b3a51b30735698288c2f4aef21c2f288a906d5af4df7bd9ff0deceadb652bed72f8957f1d095d424cf9a21cd9635a6469c9c4264e8053104f7b850486d49021a8a600a46e3c69d8285d5a18123cc9c6dccce0fbb071f2a1cce2e958a5aa59439f60b5fd43d48dc017040077eb74dcfa89e6397726af90f06f9e8864b6fae58a862a676d4a4839e4b01731dbe1f4be932d6b53c245e6166755a85110f5cd9acea162567dba67358347b9410db9e5ff17163298d7ef8b2699d62db8632821a078f5493e76291f683877cdba03fb9abc99f80af19303b299341d4c13399b33bef980097f3d9fe539b4ac72d29964bc04ce1b8e3f82e9ac2f06223123ca015f3fa77315d70f667e15bf5a41a637e7e3b8acad5b318e29c698997db146095ac1576c30b7454946a3bd26677020507fbd22ef8183c6393082b48d1ca3e283f75d1efa9377faecdeece4402fe58e7f7572bbbb312f611253a4517c936687a6b61606494fa35fb43ecba1c8c1689373edb085b86735694b29f8dfc0ef6e3e0e7845dc83e600892d6cef7ea8f31683fbc0996b7081b2980a84e144719082caf7527af9fb4392a4ad20588b5947abb33ed0ca9a5e71748019d4e2ee81653995cdb6aa17bf3db02d1febedb90ab534714441ee7a77921337852b9bd1c10390ad40d32b96166da8cba479974f39db9d78d2851c11dff569fd5a512e1e47d320ed22a00654a5362ec219ffdfea13f9bd2f55d7ff4e5e40f10bf10026dce0133305d84860feacedf6944789dc40405689a05ee753f6e2b6238da6f46a9cf2b1ac8cc0d74f81695118243d3a0a3b6faac1d41c8',
        },
        {
          wif: '2SBqZRcBcRuuSresM76sFWrLR83G3WsMUvhwtJezKYjY9tWBiUyFHGdVWGGiuzmV5kexVoK9xUAFctMM44XxWXN81o8jtwy',
          priv: '900f1b6da2cdfa15ed58de960b506b391bc7eab147d117a89b212359e7804676aa06427f9d7ccfbffaeae6d995c7e41f3621c6eb0d87892979aafcd1abc1f9b677',
          pub: '040103000610136ea636ef3b08e1c870cdbc465fa1d06910d0bef258fa2c9b9188be44728bc653fecd01996d7983ff1b08e7dbef575827a1dfba426bca85ca2ce92be43bbdf129ecd6baaa124d880033e67f2d17b6518d1f2ab2a842d7d0d6afdde1f8154ae55793136dae0e1c4329d22f65c90113d46f039e59ad7ab1fee39017dfcfa682c58cdab25e2c988233714d3c6a4471d80c83ce93fa709711cb2cf3abdee2747bb7c5d3da98aa7116557f772edcf0b54ac28d31fa3fac1f9505233e24cefee93e3620ffed26e3ad783ba4efea6c7a0a60711b7c55b4d6e171b21a05e28afc433115c5ba505564da03303ce6a25d7b086e558241bc2489c7ec1b5de13268ad42245dce4b9bcdf2b1afed1d28abf31d40aebf67cf6a5c9c1d7c51f799bc33282585f8b48207317a647ebdb3d5778f5ef021f8063ddc1eabb122d9a039c248b9eb785947337e610cf88c5af72adf4e06807c01153f10151eb4a413b2d49c59c3e0373fecf33c744d390e389ada0079f4651205cae6272ab1aba2cb9882183b817ab04420fc840c305bda4e119c3784679fbcc1f68091c7237428390752ec1c9f873c9aa860bbfaf471224812d3c4abc86b5d066c578a661303dc1ba00dd45487181a056a19a3c69d43cb43e0b8c8de143099d2350487656d448007d6cb992d5d930ea804b711bfe6d70c4adff2aa8e8f3c68970dfdb90d11d5a05ab612259e2008ea0fe845dad4fcba5788661b3e031e06ff3b1964e67ed8ebdca6f693decfc4333a60411af0fb8dc2fabd2289d42418dcbf991b38a6c17186c9d4b59d84a7cb177dadafbc506baf3fbf37f2145b680da36f4c03a0c46691a170a95cf7a576d43c9f3c327d7f73e6d96d9f3f356b8ce6f1afe092d266c02c06d1621ffbb6f7eaec4ed18a78d8e0cbd8278ee85a3dda155c7512c6c4783bc3767b14c8467d2580645c57c072ed0bda8116d65fdf9113a34e31a44726a4899c3b551b4f6f572c09930411e90c736c301301ecfcb20cfae6a46b87fc63a123ce8957e409e1c66463c5e1d9012c259ff532789d5898227e5c0b7e49868a040327b63975bccda0e23dce1b6427b0a4c087c62b01a2142d5930999415aa56d4541807ba12e025f1178debf7d2891483f344f6d8bd7f1df4a76064f647c9f78761a303d7070e8bb7b1d15a982dd63ba19551b785ad2b8c40095810628b3596d3a94724eb152adeeda876c48f52f7f7aaea92ba9906434525ece707d979444da8672a65dc03d381a46cab202aca9b1694f9caaf019f0e3455da2cf3ba4616acd0613a21ad6c25a7cb7c398cafdafb3eddd3a0290dd39bb9447c4f46e7b81427537ecb50905c676ed6e553bbf6a753207e71f9367d0bff6432e44f33f269ea085d35a90a914e90bb55e7ba05eceb5a7efda8c712f0051df0cd2027928e805e874bb4bba1c0d6b2c0f5eedca8',
        }
      ];

      for (let i = 0; i < knownKeys.length; i++) {
        // const privkey = PrivateKey.fromRandom()
        // const pubkey = privkey.toPublicKey()
        // console.log(privkey.toString(), privkey.toWIF(), pubkey)
        const privkey = new PrivateKey(knownKeys[i].wif);
        const pubkey = privkey.toPublicKey();
        pubkey.toString().should.equal(knownKeys[i].pub);
      }
    });

    it('from a compressed public key', () => {
      const publicKeyHex = '04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106';
      const publicKey = new PublicKey(publicKeyHex);
      publicKey.toString().should.equal(publicKeyHex);
    });


    it('from another publicKey', () => {
      const publicKeyHex = '04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106';
      const publicKey = new PublicKey(publicKeyHex);
      const publicKey2 = new PublicKey(publicKey);
      publicKey.should.equal(publicKey2);
    });

    it('sets the network to defaultNetwork if none provided', () => {
      const publicKeyHex = '04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106';
      const publicKey = new PublicKey(publicKeyHex);
      publicKey.network.should.equal(Networks.defaultNetwork);
    });
  });


  describe('#getValidationError', () => {
    it('should recieve a boolean as true for uncompressed', () => {
      const valid = PublicKey.isValid('04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106');
      valid.should.equal(true);
    });
  });

  describe('#json/object', () => {
    it('should input/ouput json', () => {
      const json = JSON.stringify({
        buffer: '04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106',
        compressed: true
      });
      const pubkey = new PublicKey(JSON.parse(json));
      JSON.stringify(pubkey).should.deep.equal(json);
    });

    it('fails if invalid JSON is provided', () => {
      expect(() => {
        return PublicKey._transformJSON('¹');
      }).to.throw();
    });
  });

  describe('#fromPrivateKey', () => {
    it('should make a public key from a privkey', () => {
      should.exist(PublicKey.fromPrivateKey(PrivateKey.fromRandom()));
    });

    it('should error because not an instance of privkey', () => {
      (function () {
        PublicKey.fromPrivateKey(new Error());
      }).should.throw('Must be an instance of PrivateKey');
    });
  });

  describe('#fromBuffer', () => {
    it('should throw an error on this invalid public key', () => {
      (function () {
        PublicKey.fromBuffer(new Buffer('091ff0fe0f7b15ffaa85ff9f4744d539139c252a49710fb053bb9f2b933173ff9a', 'hex'));
      }).should.throw();
    });

    it('should throw error because not a buffer', () => {
      (function () {
        PublicKey.fromBuffer('091ff0fe0f7b15ffaa85ff9f4744d539139c252a49710fb053bb9f2b933173ff9a');
      }).should.throw('Must be a hex buffer of DER encoded public key');
    });
  });

  describe('#fromDER', () => {
    it('should parse this uncompressed public key', () => {
      const pk = PublicKey.fromDER(new Buffer('04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106', 'hex'));
    });

    it('should throw an error on this invalid public key', () => {
      (function () {
        PublicKey.fromDER(new Buffer('091ff0fe0f7b15ffaa85ff9f4744d539139c252a49710fb053bb9f2b933173ff9a', 'hex'));
      }).should.throw();
    });
  });

  describe('#fromString', () => {
    it('should parse this known valid public key', () => {
      const pk = PublicKey.fromString('04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106');
    });
  });


  describe('#toDER', () => {
    it('should return this uncompressed DER format', () => {
      const pk = PublicKey.fromString('04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106');
      pk.toDER().toString('hex').should.equal('04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106');
    });
  });

  describe('#toAddress', () => {
    it('should output this known mainnet address correctly', () => {
      const pk = new PublicKey('04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106');
      const address = pk.toAddress('livenet');
      address.toString().should.equal('GK5rMDZwypTxnMmn4DcGEf6BrEMG6b28Y8');
    });

    it('should output this known testnet address correctly', () => {
      const pk = new PublicKey('048204080382040400010300061028404f5db24e6a34b31813ec990f29a11b0a6b2e54f4d0f3e77e6a345b7929ee6396b495c61328dd83a2a2b7c300f96cdbf4d66d968d17afc1d0561ea6d322fc1d7140a75ec341a74382e23357922191668c60aab3e5c654dd4cc6b1e4a5805a525c81f93751baffeccb90154471675a2123720c480fff31e4a2d206e8aa90969aabf09ce3bee7a01737e01ac82cfcaa2b3c75537e6c9165e5df27aa1a857d2d90bbc0dc3b5ee80933308827b33bb03c82303a4c610af316a99ce0892420163f5f89dbf3b9f53befcd8b27d9ad2fc7f679da8153e83092188a995d8be8dfb4c382a1f042f1f5e844aca761591f3d28ff77a449f015ddc0b08cb673076530f638ec5723862b49eefbfd0cf1ff2e57abd1acfb66dc85717b46976e758153f71ffc94a3dbd7873bfa45afafd8006450bdac6912c08757f2ff4799e63af4598b7b3fcae3e8d8e9378a0621937422ef3452b241f0ad0c7d79627451af725f992736e3a35431e65d0d267f533ebaa62b28a139c74a73623c67c964cef7497b63a6658f3e2bfc78e46ffce141c5a081196b3186a87cadc9f630914fca59558c1fdfff25daa46f5aa6cc43ae80f07a52f7b23313553ffac916b459d501219866b99c28cb7a92dc55d8ea1121c3ae0bb73db196fec2d2c11322b1d9eb0a13ed9dc01b57dc0ebefc3cbfc9108a9e3d8d0d7e5d05fbe0264bb2b5019f37e73d42034a30f2ccf8a98c620911a742d31f2d5266f1a8c272e77d432f64bf74357489f9a0ad66a720be7d9d2b3efea80b1ac7dc2682253f6d72de3ec7505085552744185b5e8f34982ffaaacf492728de9e7ea0bb5e10a2be0985147a46047fb6c9252fe4aa35d8a2cfb479b6855417d0b9039ff57ec3923714adc8c8f1e5da3e722e355b6eefee6758f46f060635261f365ded95f1cbd7bba31a1d9a2ec9af8f2fc1fa91ed0d7c05e1a3e66a49d1beec5ceb6b3027fb5d0fd703cf3186e3b623f296e4e5fefe67662fe9d98cb84a625201a1dc163eb80eb448cfce79ddd32b0594ce695712de6bf3a01e56d4279b41fc3f97693cf1a246e5dac4b005605f44ddd34c28cd1e48e160ef06aecb47d52772ad910e59dc9a8289fb52d19d2aadba07f3975089e77b01c0ec418f78e8638df8260c31fb45afc2cb06c67640b65cb8fae02acd85999b15f88d9ec4c0118db20c0914ab0331a4ca14b9b5cc757edea4670d38f6b60e81100c3b128e4e21cedaeaaa991a77b247da1fee300ae3575303eba946ddbeb76b5f428c05bb8ce95541aa272b4c583120839b025736097e4a12f9c4455bf7eaa252a37de98c6acc0d68ab781f529b2631d4a278db6b8933bfc034496d3bfaee6b5ee4e07c00d74eb0054e1369ef21bd0edc8e987a3417e748f802c2a2aa5f9c8b0f7d1dc229998b04118ce4af10a49ae493a5e08acf80b8965c2c730d658e60');
      const address = pk.toAddress('testnet');
      console.log(address);
      address.toString().should.equal('LSwaRa3XZfqYGSpxWF4YkCrbogvQDLYbaF');
    });
  });

  describe('#toString', () => {
    it('should print this known public key', () => {
      const hex = '04820408038204040080c00060081402f2ba4d72562ccd18c83799f09485d850d6742a2f0bcfe77e562cda9e9477c6692da963c814bbc14545edc3009f36db2f6bb669b1e8f5830b6a7865cb443fb88e02e57ac382e5c24147ccea49848966310655cda7632abb32638d27a5015a4a3a819fec8a5dff37d309a8228ee65a84c44e3012f0ff8c27454b601755096959d50f39c77de705e8ec075813343f55d43caeca7e3689a6a7fbe45558a1beb409dd033bdc7a1790cc0c11e4cddc0d3c410c5c328650cf6895390791240468fcfa91dbcf9dafdcf7b3d1e49bb5f4e36f9e5b81ca170c49185199bad117fb2dc341850f428faf172235e5869af8bc14ffee25920fa8bb030d316dcee0a60c6f1c37eac461d49277dfbf308fff74ead58b35df663ba18ede62e976ae81caeff83f29c5dbebe1dc5fa2f5f51b00260abd35964803e1ea4fffe299675c2f9ad1defc53c7171b97ec516084c92e44f72c4a4d820fb530be9e462e8af54efa99e46cc7c52a8c67bab064feca7c5d65d414859ce352ce463ce6932673ef92dec665a6f17cd43f1e27f63f8782a3058198d68c61153eb5936f0c89f2539aaa31f8fbffa45b25f65a6533c275010f5e4aef4dccc8aafc5f93682d9aab808419669d3914d35e493baa1b578884c375d0edbc8d697f434b83c8448d9bd750c8b7b903d8ea3b707d3f3cfd93085179bcb1b07ebaa0df0764d24dad80f9ece7bc42c0520c4f331f9531469088e542cbf8b44a668f15434ee7bec2f426fd2eac2e919f05b566e5047dbeb9d47c7f15d058e33b6441a4fcb64e7b7ce30a0aa1aae42218da7af12c19f45f55f392e4147b797e05dd7a08457d90a1285e6220fe6d93a4f42755ac1b45f32d9e6da12ae80b9dc0f9af7ec349ec28b513138fa75b7c4e74acda76f777e61a2ff66060ac64f86cbab7a98fd3ebddc558b8597493f5f1f4835f89b7b03ea087c56756928b7d373ad7d60ce4dfbaf0ebc0f38c61c76dc44f6927a77f7fe666f4979b311d52464a80853b687c1d702d12f3739ebbcbd4a0297396ea487bd6cf05786a2be4d9823ffce9963c8f4562a75b230da006fa22bbcb3214b378128706f76075d3e2abe44eb589709a3b594191df4a8bb954b55de0cfe90a91e7de80033782f11e17c6b11f64308cdfa2f543d360636e026d3a1d5f0754b3a199d9a81fb179230388b14d309028d5c08c2553289dad33ae7e7b25e6b01c6f6d70810830dc48717284735b57559958ee4de25bf8770c50c7eacac0d79562bb7dedd6fa4231a0dd3197aa8255e4d4321a8c04c1d940ea6c907e52489f23a2daef57454ac5be97315633b016d51ef84ad9648c2b451edbd691ccfd032c92b6dc5f77d67a27073e00eb720da072c896f784bd703b71195e2ce8e7121f40434555fa39d1f0beb8439499d120883127f508255927c9a50751f3011d693a34ceb0a67106';
      const pk = PublicKey.fromString(hex);
      pk.toString().should.equal(hex);
    });
  });

  describe('#inspect', () => {
    it('should output known uncompressed pubkey for console', () => {
      const pubkey = PublicKey.fromString('048204080382040400010300061028404f5db24e6a34b31813ec990f29a11b0a6b2e54f4d0f3e77e6a345b7929ee6396b495c61328dd83a2a2b7c300f96cdbf4d66d968d17afc1d0561ea6d322fc1d7140a75ec341a74382e23357922191668c60aab3e5c654dd4cc6b1e4a5805a525c81f93751baffeccb90154471675a2123720c480fff31e4a2d206e8aa90969aabf09ce3bee7a01737e01ac82cfcaa2b3c75537e6c9165e5df27aa1a857d2d90bbc0dc3b5ee80933308827b33bb03c82303a4c610af316a99ce0892420163f5f89dbf3b9f53befcd8b27d9ad2fc7f679da8153e83092188a995d8be8dfb4c382a1f042f1f5e844aca761591f3d28ff77a449f015ddc0b08cb673076530f638ec5723862b49eefbfd0cf1ff2e57abd1acfb66dc85717b46976e758153f71ffc94a3dbd7873bfa45afafd8006450bdac6912c08757f2ff4799e63af4598b7b3fcae3e8d8e9378a0621937422ef3452b241f0ad0c7d79627451af725f992736e3a35431e65d0d267f533ebaa62b28a139c74a73623c67c964cef7497b63a6658f3e2bfc78e46ffce141c5a081196b3186a87cadc9f630914fca59558c1fdfff25daa46f5aa6cc43ae80f07a52f7b23313553ffac916b459d501219866b99c28cb7a92dc55d8ea1121c3ae0bb73db196fec2d2c11322b1d9eb0a13ed9dc01b57dc0ebefc3cbfc9108a9e3d8d0d7e5d05fbe0264bb2b5019f37e73d42034a30f2ccf8a98c620911a742d31f2d5266f1a8c272e77d432f64bf74357489f9a0ad66a720be7d9d2b3efea80b1ac7dc2682253f6d72de3ec7505085552744185b5e8f34982ffaaacf492728de9e7ea0bb5e10a2be0985147a46047fb6c9252fe4aa35d8a2cfb479b6855417d0b9039ff57ec3923714adc8c8f1e5da3e722e355b6eefee6758f46f060635261f365ded95f1cbd7bba31a1d9a2ec9af8f2fc1fa91ed0d7c05e1a3e66a49d1beec5ceb6b3027fb5d0fd703cf3186e3b623f296e4e5fefe67662fe9d98cb84a625201a1dc163eb80eb448cfce79ddd32b0594ce695712de6bf3a01e56d4279b41fc3f97693cf1a246e5dac4b005605f44ddd34c28cd1e48e160ef06aecb47d52772ad910e59dc9a8289fb52d19d2aadba07f3975089e77b01c0ec418f78e8638df8260c31fb45afc2cb06c67640b65cb8fae02acd85999b15f88d9ec4c0118db20c0914ab0331a4ca14b9b5cc757edea4670d38f6b60e81100c3b128e4e21cedaeaaa991a77b247da1fee300ae3575303eba946ddbeb76b5f428c05bb8ce95541aa272b4c583120839b025736097e4a12f9c4455bf7eaa252a37de98c6acc0d68ab781f529b2631d4a278db6b8933bfc034496d3bfaee6b5ee4e07c00d74eb0054e1369ef21bd0edc8e987a3417e748f802c2a2aa5f9c8b0f7d1dc229998b04118ce4af10a49ae493a5e08acf80b8965c2c730d658e60');
      pubkey.inspect().should.equal('<PublicKey: 048204080382040400010300061028404f5db24e6a34b31813ec990f29a11b0a6b2e54f4d0f3e77e6a345b7929ee6396b495c61328dd83a2a2b7c300f96cdbf4d66d968d17afc1d0561ea6d322fc1d7140a75ec341a74382e23357922191668c60aab3e5c654dd4cc6b1e4a5805a525c81f93751baffeccb90154471675a2123720c480fff31e4a2d206e8aa90969aabf09ce3bee7a01737e01ac82cfcaa2b3c75537e6c9165e5df27aa1a857d2d90bbc0dc3b5ee80933308827b33bb03c82303a4c610af316a99ce0892420163f5f89dbf3b9f53befcd8b27d9ad2fc7f679da8153e83092188a995d8be8dfb4c382a1f042f1f5e844aca761591f3d28ff77a449f015ddc0b08cb673076530f638ec5723862b49eefbfd0cf1ff2e57abd1acfb66dc85717b46976e758153f71ffc94a3dbd7873bfa45afafd8006450bdac6912c08757f2ff4799e63af4598b7b3fcae3e8d8e9378a0621937422ef3452b241f0ad0c7d79627451af725f992736e3a35431e65d0d267f533ebaa62b28a139c74a73623c67c964cef7497b63a6658f3e2bfc78e46ffce141c5a081196b3186a87cadc9f630914fca59558c1fdfff25daa46f5aa6cc43ae80f07a52f7b23313553ffac916b459d501219866b99c28cb7a92dc55d8ea1121c3ae0bb73db196fec2d2c11322b1d9eb0a13ed9dc01b57dc0ebefc3cbfc9108a9e3d8d0d7e5d05fbe0264bb2b5019f37e73d42034a30f2ccf8a98c620911a742d31f2d5266f1a8c272e77d432f64bf74357489f9a0ad66a720be7d9d2b3efea80b1ac7dc2682253f6d72de3ec7505085552744185b5e8f34982ffaaacf492728de9e7ea0bb5e10a2be0985147a46047fb6c9252fe4aa35d8a2cfb479b6855417d0b9039ff57ec3923714adc8c8f1e5da3e722e355b6eefee6758f46f060635261f365ded95f1cbd7bba31a1d9a2ec9af8f2fc1fa91ed0d7c05e1a3e66a49d1beec5ceb6b3027fb5d0fd703cf3186e3b623f296e4e5fefe67662fe9d98cb84a625201a1dc163eb80eb448cfce79ddd32b0594ce695712de6bf3a01e56d4279b41fc3f97693cf1a246e5dac4b005605f44ddd34c28cd1e48e160ef06aecb47d52772ad910e59dc9a8289fb52d19d2aadba07f3975089e77b01c0ec418f78e8638df8260c31fb45afc2cb06c67640b65cb8fae02acd85999b15f88d9ec4c0118db20c0914ab0331a4ca14b9b5cc757edea4670d38f6b60e81100c3b128e4e21cedaeaaa991a77b247da1fee300ae3575303eba946ddbeb76b5f428c05bb8ce95541aa272b4c583120839b025736097e4a12f9c4455bf7eaa252a37de98c6acc0d68ab781f529b2631d4a278db6b8933bfc034496d3bfaee6b5ee4e07c00d74eb0054e1369ef21bd0edc8e987a3417e748f802c2a2aa5f9c8b0f7d1dc229998b04118ce4af10a49ae493a5e08acf80b8965c2c730d658e60>');
    });

    it('should output known compressed pubkey with network for console', () => {
      const privkey = PrivateKey.fromWIF('2SRLnpdFnpiqzeAbJXSBoLeCvG65m7ham4N7ZuFuSgRSAmAVQwKDVrJnui3gY4Ywv7ZFVeW5QuFC4oakVAxetMxGVnvEyct');
      const pubkey = new PublicKey(privkey);
      pubkey.inspect().should.equal('<PublicKey: 040103000610215874f73711ea094fc6f9d9a91dd1322dc34c68f5d772422020f16698bdce308f976b915f2e1a1d7ea0441c43ffe68cba8e4b9259694b955d0098bffc544c5f7afaa964ebf80d20f0cda11d49cc2450b4e6311996e024fef832064d266a0e091794fe5d77f1b1bf7ac6c9029cd1f4e8cddea9962634ecf3b2f409ed4af48373f401e0421dd8fb9ed1a7ec6fc476e6096f61f825321d7f015b0e1ea17e44c6da08f20c6da47ee85e047edc9f469e036e01a9003ae94ccd985156a140f1d184de340eb75ed91bd7a4fb8fb32010f62f4bb8c47d100138b39047bab0ef05c3314404bd1c638467251e94a0a8bedbaeef2102d2daea25520ec634664540a3f6d740f286dbbeb35e203e76918817e57c881de898f6d47e237bd3e8a4cc47d9c9fa708fc154cbe72a5701ce5f5eb53ad9accad8df6bccaa2368a3ddc27114e0257c856b515d86a85bfa2215bcadb550931f2b73253dd966736adbd316c4a6216c23e2c8103144deb0d66429dbec181fed096a1ed0d62fc5a00af3e524a3a9322b71849a9634588cd86c4f1d46289ea13d8f43bf6bbc8b71528bdd71e26253e1b23bc7cb3b3e93cd8365e70a1789b22195438a05c6f72ed8c88b016e505c6755eb61276ce8f69139f30a77694b2a414161c5f96af13c1f414f8f83592fbd262805c40b06d98252265906bd467ebe5838c354d0da686d75fd8f61d3803089a8d1a939b54d5d0b9cb1a248f45f15138dda1ed7986bdaeb61998515c4a1425efab01481be091f8529c7bc2d43c270e59d213a798785fa3643f0767a4f382fc293414e34d7e0d75515c722846ff12d3e2aae7656bb76d81f138163d0c3d2801b6d3409b20db0b344d008dd656352bcb53bf6ac6ab8ecc342db2d5a853c93a8a3e62f141c2fd758b11ea6c8b698969c2c671ffd0009529788f46e4a24f46cf7cd43dfe1e2b4194af2039b8bc3852f320f451c034ed7f7b218c369a8075553fb50557c605885098c3853e3ca705534680fa87df4141a73324ed1b1bb17115d578df87800a4e33ba2befdc54338d1bbe031b05bab92697ab4e8d4651e249d1d126e9c78875c4f00dd6b16ab73adb65e48007d32864bd12e2cd063b85db997c25cc7645ae6ef697b8223135951f78bac79bdbcf282d729cc6b6fb9099dfc29cb2d65a49ba6b2b125375e794043fcc3cffff2378791d84079f979696abc8073c3aa6a2bad78f56b2821015376af3832972b8cbaf88a002ff09784846736284abe2b5cfc1271eef175313b5484c1e39eea47c15275759d34dabe793bbde5473b94cc3f41b44eacfe7134986d5d613effbb03865e54fc70af9ff1d1158427c5882b965a19b11dcc5acf6d840f8ff0ca0577f527b6a6883c5bfecc0ed0ef0145f1ab64861ab9b9f5b46709fe48e909db526bfccce927808e05ca040aa7fec36482dce04f5947e8, uncompressed>');
    });
  });

  describe('#validate', () => {
    it('should not have an error if pubkey is valid', () => {
      const hex = '048204080382040400010300061028404f5db24e6a34b31813ec990f29a11b0a6b2e54f4d0f3e77e6a345b7929ee6396b495c61328dd83a2a2b7c300f96cdbf4d66d968d17afc1d0561ea6d322fc1d7140a75ec341a74382e23357922191668c60aab3e5c654dd4cc6b1e4a5805a525c81f93751baffeccb90154471675a2123720c480fff31e4a2d206e8aa90969aabf09ce3bee7a01737e01ac82cfcaa2b3c75537e6c9165e5df27aa1a857d2d90bbc0dc3b5ee80933308827b33bb03c82303a4c610af316a99ce0892420163f5f89dbf3b9f53befcd8b27d9ad2fc7f679da8153e83092188a995d8be8dfb4c382a1f042f1f5e844aca761591f3d28ff77a449f015ddc0b08cb673076530f638ec5723862b49eefbfd0cf1ff2e57abd1acfb66dc85717b46976e758153f71ffc94a3dbd7873bfa45afafd8006450bdac6912c08757f2ff4799e63af4598b7b3fcae3e8d8e9378a0621937422ef3452b241f0ad0c7d79627451af725f992736e3a35431e65d0d267f533ebaa62b28a139c74a73623c67c964cef7497b63a6658f3e2bfc78e46ffce141c5a081196b3186a87cadc9f630914fca59558c1fdfff25daa46f5aa6cc43ae80f07a52f7b23313553ffac916b459d501219866b99c28cb7a92dc55d8ea1121c3ae0bb73db196fec2d2c11322b1d9eb0a13ed9dc01b57dc0ebefc3cbfc9108a9e3d8d0d7e5d05fbe0264bb2b5019f37e73d42034a30f2ccf8a98c620911a742d31f2d5266f1a8c272e77d432f64bf74357489f9a0ad66a720be7d9d2b3efea80b1ac7dc2682253f6d72de3ec7505085552744185b5e8f34982ffaaacf492728de9e7ea0bb5e10a2be0985147a46047fb6c9252fe4aa35d8a2cfb479b6855417d0b9039ff57ec3923714adc8c8f1e5da3e722e355b6eefee6758f46f060635261f365ded95f1cbd7bba31a1d9a2ec9af8f2fc1fa91ed0d7c05e1a3e66a49d1beec5ceb6b3027fb5d0fd703cf3186e3b623f296e4e5fefe67662fe9d98cb84a625201a1dc163eb80eb448cfce79ddd32b0594ce695712de6bf3a01e56d4279b41fc3f97693cf1a246e5dac4b005605f44ddd34c28cd1e48e160ef06aecb47d52772ad910e59dc9a8289fb52d19d2aadba07f3975089e77b01c0ec418f78e8638df8260c31fb45afc2cb06c67640b65cb8fae02acd85999b15f88d9ec4c0118db20c0914ab0331a4ca14b9b5cc757edea4670d38f6b60e81100c3b128e4e21cedaeaaa991a77b247da1fee300ae3575303eba946ddbeb76b5f428c05bb8ce95541aa272b4c583120839b025736097e4a12f9c4455bf7eaa252a37de98c6acc0d68ab781f529b2631d4a278db6b8933bfc034496d3bfaee6b5ee4e07c00d74eb0054e1369ef21bd0edc8e987a3417e748f802c2a2aa5f9c8b0f7d1dc229998b04118ce4af10a49ae493a5e08acf80b8965c2c730d658e60';
      expect(() => {
        return PublicKey.fromString(hex);
      }).to.not.throw();
    });
  });
});
